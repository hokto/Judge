<html>
<head><meta charset="UTF-8" />
<title>websocket ruby test</title>
<script type="text/javascript" src="http://code.jquery.com/jquery-2.1.3.min.js"></script> 
<script type="text/javascript">
$(function(){
    var ws = new WebSocket('ws://192.168.0.24:9999/');                                                                                                
    //$("#send").on('click', function(){
     //   ws.send($('#message').val());
    //});
	var sendText=null;
	var reader=new FileReader();
	var sendFile=document.getElementById("send");
	var type=null;
	var name=null;
	function fileChange(e){
			var target=e.target;
			var file=target.files[0];
			name=file.name;
			reader.readAsText(file);
	}
	function fileLoad(){
			console.log(reader.result);
	}
	sendFile.addEventListener("change",fileChange,false);
	reader.addEventListener("load",function(e){
		
		ws.send(name.split(".")[1]+":"+reader.result);

		}
	);
    ws.onmessage = function(event){
        var message_li = $('<li>').text(event.data);
        $("#msg-area").append(message_li);
    };
});
</script>
</head>
<body>
<!--<input type="button" id="send" value="send"/> -->
<input type="file" id="send"/>
<ul id="msg-area" />
</body>
</html>
